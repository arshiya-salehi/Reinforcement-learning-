Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
/opt/anaconda3/lib/python3.13/site-packages/numpy/_core/numeric.py:387: RuntimeWarning: overflow encountered in cast
  multiarray.copyto(a, fill_value, casting='unsafe')
/opt/anaconda3/lib/python3.13/site-packages/gym/utils/passive_env_checker.py:31: UserWarning: [33mWARN: A Box observation space has an unconventional shape (neither an image, nor a 1D vector). We recommend flattening the observation to have only a 1D vector or use a custom policy to properly process the data. Actual observation shape: (1, 5)[0m
  logger.warn(
/opt/anaconda3/lib/python3.13/site-packages/stable_baselines3/common/vec_env/patch_gym.py:49: UserWarning: You provided an OpenAI Gym environment. We strongly recommend transitioning to Gymnasium environments. Stable-Baselines3 is automatically wrapping your environments in a compatibility layer, which could potentially cause issues.
  warnings.warn(
/opt/anaconda3/lib/python3.13/site-packages/numpy/_core/numeric.py:387: RuntimeWarning: overflow encountered in cast
  multiarray.copyto(a, fill_value, casting='unsafe')
/opt/anaconda3/lib/python3.13/site-packages/gym/utils/passive_env_checker.py:31: UserWarning: [33mWARN: A Box observation space has an unconventional shape (neither an image, nor a 1D vector). We recommend flattening the observation to have only a 1D vector or use a custom policy to properly process the data. Actual observation shape: (1, 5)[0m
  logger.warn(
/opt/anaconda3/lib/python3.13/site-packages/stable_baselines3/common/vec_env/patch_gym.py:49: UserWarning: You provided an OpenAI Gym environment. We strongly recommend transitioning to Gymnasium environments. Stable-Baselines3 is automatically wrapping your environments in a compatibility layer, which could potentially cause issues.
  warnings.warn(
/opt/anaconda3/lib/python3.13/site-packages/gym/utils/passive_env_checker.py:141: UserWarning: [33mWARN: The obs returned by the `reset()` method was expecting numpy array dtype to be float32, actual type: float64[0m
  logger.warn(
/opt/anaconda3/lib/python3.13/site-packages/gym/utils/passive_env_checker.py:165: UserWarning: [33mWARN: The obs returned by the `reset()` method is not within the observation space.[0m
  logger.warn(f"{pre} is not within the observation space.")
/opt/anaconda3/lib/python3.13/site-packages/gym/utils/passive_env_checker.py:219: DeprecationWarning: [33mWARN: Core environment is written in old step API which returns one bool instead of two. It is recommended to rewrite the environment with new step API. [0m
  logger.deprecation(
Using cpu device
Training DQN agent with load pattern: RANDOM
Total timesteps: 200000
Model will be saved as: dqn_model
Traceback (most recent call last):
  File "/Users/arshiyasalehi/Desktop/CS175 gym envirment project/gym-scaling/src/train_dqn_sb3.py", line 132, in <module>
    train_dqn(
    ~~~~~~~~~^
        load_pattern=args.pattern,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
        model_name=args.name,
        ^^^^^^^^^^^^^^^^^^^^^
        total_timesteps=args.timesteps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/arshiyasalehi/Desktop/CS175 gym envirment project/gym-scaling/src/train_dqn_sb3.py", line 101, in train_dqn
    model.learn(
    ~~~~~~~~~~~^
        total_timesteps=total_timesteps,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        callback=[checkpoint_callback, eval_callback],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        log_interval=10
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/lib/python3.13/site-packages/stable_baselines3/dqn/dqn.py", line 272, in learn
    return super().learn(
           ~~~~~~~~~~~~~^
        total_timesteps=total_timesteps,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        progress_bar=progress_bar,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/lib/python3.13/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 335, in learn
    rollout = self.collect_rollouts(
        self.env,
    ...<5 lines>...
        log_interval=log_interval,
    )
  File "/opt/anaconda3/lib/python3.13/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 567, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(actions)
                                     ~~~~~~~~^^^^^^^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
           ~~~~~~~~~~~~~~^^
  File "/opt/anaconda3/lib/python3.13/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
                                                                                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.actions[env_idx]
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/lib/python3.13/site-packages/stable_baselines3/common/monitor.py", line 94, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
                                                       ~~~~~~~~~~~~~^^^^^^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/shimmy/openai_gym_compatibility.py", line 116, in step
    return self.gym_env.step(action)
           ~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/arshiyasalehi/Desktop/CS175 gym envirment project/gym-scaling/src/env_wrapper.py", line 43, in step
    obs, reward, done, info = self.env.step(action)
                              ~~~~~~~~~~~~~^^^^^^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/gym/wrappers/order_enforcing.py", line 37, in step
    return self.env.step(action)
           ~~~~~~~~~~~~~^^^^^^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/gym/wrappers/env_checker.py", line 37, in step
    return env_step_passive_checker(self.env, action)
  File "/opt/anaconda3/lib/python3.13/site-packages/gym/utils/passive_env_checker.py", line 225, in env_step_passive_checker
    if not isinstance(done, (bool, np.bool8)):
                                   ^^^^^^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/numpy/__init__.py", line 795, in __getattr__
    raise AttributeError(f"module {__name__!r} has no attribute {attr!r}")
AttributeError: module 'numpy' has no attribute 'bool8'. Did you mean: 'bool'?
